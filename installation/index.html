<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Phil Ewels">
        
        <link rel="shortcut icon" href="../img/favicon.ico">

        <title>Installation - NGI Reports</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/prettify-1.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">NGI Reports</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="active">
                    <a href=".">Installation</a>
                </li>
            
            
            
                <li >
                    <a href="../usage">Usage</a>
                </li>
            
            
            
                <li >
                    <a href="../contributing">Contributing</a>
                </li>
            
            
            
                <li >
                    <a href="../report_project_report">Project Reports</a>
                </li>
            
            
            
                <li >
                    <a href="../report_ign_sample_report">IGN Sample Reports</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="..">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../usage">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/NationalGenomicsInfrastructure/ngi_reports/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#installation">Installation</a></li>
        
            <li><a href="#ngi_reports-python-package">ngi_reports Python Package</a></li>
        
            <li><a href="#bash-commands">Bash Commands</a></li>
        
            <li><a href="#ngi_visualizations">ngi_visualizations</a></li>
        
            <li><a href="#status-db">Status DB</a></li>
        
            <li><a href="#pandoc-conversion">Pandoc Conversion</a></li>
        
            <li><a href="#xelatex">XeLaTeX</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="installation">Installation</h1>
<h2 id="ngi_reports-python-package">ngi_reports Python Package</h2>
<p>To create reports you need to install the <code>ngi_reports</code> package.
First, either download or clone the <a href="https://github.com/NationalGenomicsInfrastructure/ngi_reports">repository</a>.
Make sure that you include the <code>--recursive</code> flag:</p>
<pre><code>git clone --recursive https://github.com/NationalGenomicsInfrastructure/ngi_reports.git
</code></pre>

<p><em>(remember to fork instead if you intend to make changes to the code)</em></p>
<p>Next, install the package by running:</p>
<pre><code>cd ngi_reports
python setup.py install
</code></pre>

<p>You also need to install the <code>pandocfilters</code> submodule:</p>
<pre><code>cd data/pandoc_templates/pandocfilters/
python setup.py install
</code></pre>

<p>These commands should install all dependencies so that the python code is ready to run.
If you're intending to make changes to the code, use <code>develop</code> instead of <code>install</code>
so that you don't need to run the setup script each time you make a change.</p>
<p>Next, you need a config file in your home directory called
<code>~/.ngi_config/ngi_reports.conf</code>. This file should be formatted for
<a href="https://docs.python.org/2/library/configparser.html">Python ConfigParser</a>
and look like this:</p>
<pre><code class="ini">[ngi_reports]
support_email: genomics_support@scilifelab.se
ngi_node: stockholm

[organism_names]
hg19: Human
hg18: Human
mm10: Mouse
mm9: Mouse
canFam3: Dog
canFam2: Dog
sacCer2: Saccharomyces cerevisiae
TAIR9: Arabidopsis
rn5: Rat
rn4: Rat
WS210: C. elegans
xenTro2: Xenopus
dm3: Drosophila
</code></pre>

<p>Obviously, if you're working at the Uppsala NGI node, change the <code>ngi_node</code> to
<code>uppsala</code> instead of <code>stockholm</code>. The <code>organism_names</code> section should have
reference id key - text pairs. This is used to make the report more verbose.</p>
<p><strong>Note:</strong> In production, <code>ngi_reports</code> is run as the <code>funk</code> user by both
Stockholm and Uppsala nodes. Here, the config file should <em>not</em> contain the
<code>ngi_node</code> option. The code will try to guess the node from Piper XML files
or can be specified with the <code>--ngi_node</code> command line parameter.</p>
<h2 id="bash-commands">Bash Commands</h2>
<p>To use <code>ngi_reports</code> from the command line easily, there are some bash commands
that you need. These are written into a bash script to make life easy - you need to add
this to your <code>~/.bashrc</code> file (<code>~/.bash_profile</code> on a mac):</p>
<pre><code>source ~/opt/ngi_reports/scripts/start_ngi_reports.sh
</code></pre>

<p><strong>note that you need to change the path to point to your ngi_reports directory..</strong></p>
<p>If you are running <code>ngi_reports</code> on Uppmax, use the following script instead:</p>
<pre><code>source ~/opt/ngi_reports/scripts/uppmax_ngi_reports.sh
</code></pre>

<h2 id="ngi_visualizations">ngi_visualizations</h2>
<p>The <code>ngi_reports</code> scripts use a separete Python module called <code>ngi_visualizations</code>.
You can find this repository along with installation instructions on github:
<a href="https://github.com/NationalGenomicsInfrastructure/ngi_visualizations">ngi_visualizations</a></p>
<p>At the time of writing, the package could be installed as follows:</p>
<pre><code class="bash">git clone https://github.com/NationalGenomicsInfrastructure/ngi_visualizations.git
cd ngi_visualizations
python setup.py install
</code></pre>

<h2 id="status-db">Status DB</h2>
<p>If you're running <code>ngi_reports</code> from the Stockholm NGI node, you'll need access
to Status DB. This is done using the <a href="https://github.com/SciLifeLab/statusdb">statusdb</a>
python package. See that readme for installation instructions (it's very similar to the
above, but I don't want to duplicate it here in case it gets out of date).</p>
<h2 id="pandoc-conversion">Pandoc Conversion</h2>
<p><strong>Only read this if you're NOT running on UPPMAX</strong></p>
<p>NGI reports use <a href="http://johnmacfarlane.net/pandoc/">Pandoc</a>
to convert the autogenerated Markdown files into HTML and PDF reports.
Head to the <a href="http://johnmacfarlane.net/pandoc/installing.html">pandoc installation page</a>
and download the appropriate version for your system. Make sure that you also
download and install LaTeX and all of the LaTeX packages that you can get your
hands on.</p>
<p><em>Note:</em> nestor and milou UPPMAX clusters have pandoc installed, but a very old version.
This software has been build and tested with Pandoc v1.13.1 and won't work with
version 1.9.4.1 which is on UPPMAX. There is a stand alone binary of pandoc which
is bundled with the repository (<code>ngi_reports/data/pandoc_templates/pandoc</code>)
which does work, however. If you use the UPPMAX bash script (see above) then
the commands should use this binary and everything should work.</p>
<h2 id="xelatex">XeLaTeX</h2>
<p><strong>Only read this if you're NOT running on UPPMAX</strong></p>
<p>The PDF conversion step uses XeLaTeX to render TeX to PDF.  If you're using a Mac,
download and install <a href="http://www.tug.org/mactex/morepackages.html">BasicTeX</a>
If you're using a PC, install <a href="http://miktex.org/">MiKTeX</a></p>
<p>Again, the UPPMAX installation of LaTeX and XeLaTeX isn't good enough for
what we need, and again, we use a portable installation. This is too big to put
on GitHub (&gt; 4gb) and so is stored the group directory. The following lines in
<code>uppmax_ngi_reports.sh</code> make it available for us on Nestor:</p>
<pre><code># Add XeLaTeX to the path
export PATH=/apus/v1/a2012043_nobackup/software/TeXLive/bin/x86_64-linux:$PATH
</code></pre>

<p>As with above - if you're using the UPPMAX bash script then
everything <em>should</em> work..</p>
<p>If for whatever reason that <em>doesn't</em> work (wrong group permissions or something)
then you can generate this software yourself by downloading and installing a portable
version of <a href="https://www.tug.org/texlive/doc/texlive-en/texlive-en.html#tlportable">TeXLive</a>.
You'll need to add this directory to your path by editing the <code>ngi_reports</code> bash script.</p>
<h3 id="fonts">Fonts</h3>
<p>The LaTeX to PDF conversion uses two fonts - <strong>Helvetica Neue</strong> for headings
and body text, and <strong>Consolas</strong> for code. These come bundled in the repository
in <code>ngi_reports/data/pandoc_templates/assets/fonts/</code>. If you don't have them installed
the PDF should still look correct (as it references this path directly when generating
the output), but the HTML may not render properly. If so, you can install these fonts
on your local machine from that directory.</p>
</div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script src="../js/base.js"></script>
    </body>
</html>